@page "/rules/playing-the-game"
@using Flowbite.Components.Markdown
@inject IWebHostEnvironment Environment

<PageTitle>Playing the Game - Rules Reference - Riddle</PageTitle>

<div class="max-w-4xl mx-auto">
    <nav class="mb-6">
        <a href="/rules" class="inline-flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
            Back to Rules Reference
        </a>
    </nav>

    @if (_isLoading)
    {
        <div class="flex items-center justify-center py-12">
            <Spinner Size="SpinnerSize.Lg" />
        </div>
    }
    else if (!string.IsNullOrEmpty(_errorMessage))
    {
        <div class="p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800">
            <p class="text-red-700 dark:text-red-300">@_errorMessage</p>
        </div>
    }
    else
    {
        <MarkdownContent Markdown="@_markdownContent" Class="max-w-none" />
    }
</div>

@code {
    private string _markdownContent = "";
    private string _errorMessage = "";
    private bool _isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        await LoadContent();
    }

    private async Task LoadContent()
    {
        try
        {
            var markdownPath = Path.Combine(Environment.WebRootPath, "docs", "playing_the_game.md");
            if (File.Exists(markdownPath))
            {
                _markdownContent = await File.ReadAllTextAsync(markdownPath);
            }
            else
            {
                _errorMessage = "The rules document could not be found.";
            }
        }
        catch (Exception ex)
        {
            _errorMessage = $"Error loading rules: {ex.Message}";
        }
        finally
        {
            _isLoading = false;
        }
    }
}
